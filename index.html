<!doctype html>
<html lang="zh-CN">
  <head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <title>PS4Broadcast Control Panel</title>
  </head>
<body>
<p>Twitch Id:</p>
<input type="textbox" id="tid" style="width:30%">
<p>Douyu Room Id:</p>
<input type="textbox" id="rid" style="width:30%">
<p>URL:</p>
<input type="textbox" id="url" style="width:30%">
<p>CODE:</p>
<input type="textbox" id="code" style="width:30%"><input type="button" value="Reset Living" onclick="resetLiving()">
<input type="button" value="Update & Restart" onclick="updateandrestart()">
<p>Messages:</p>
<textarea id="messages" style="width:100%;height:400px">
</textarea>
<script src="/socket.io/socket.io.js"></script>
<script>
	var socket = io();
		socket.on("message", function(m){
			var  messages = document.getElementById("messages");
			if(messages.scrollHeight > 5000){
				messages.value = "";
			}
			messages.value = messages.value += m +"\n";
			messages.scrollTop = messages.scrollHeight;
		});

		socket.on("living", function(status){
			var  messages = document.getElementById("messages");
                        messages.value = messages.value += "LIVING STATUS: "+ status +"\n";
		});
			
		socket.on("lastState", function(lp){
			document.getElementById("tid").value=lp.tid;
			document.getElementById("rid").value=lp.rid;
			document.getElementById("url").value=lp.url;
		});
		socket.on("error", function(error){
			console.log(error);
		});

	function updateandrestart(){
		socket.emit("updateandrestart");
	}

	function resetLiving(){
		var  messages = document.getElementById("messages");
		messages.value = "";
		socket.emit("resetlive",{
					tid:document.getElementById("tid").value,
					rid:document.getElementById("rid").value,
					url:document.getElementById("url").value, 
					code:document.getElementById("code").value});
	}
</script>
</body>
</html>
